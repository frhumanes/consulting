{% extends "ui/app.html" %}

{% load i18n%}

{% block js_files %}
  {{ block.super }}
  <script src="{{ STATIC_URL }}js/spin.min.js"></script>
{% endblock %}

{% block container %}
<div class="page-header">
<h1>{% trans 'Encuestas sin completar' %}</h1>                
</div>
<section>
  <div class="">
    {% if tasks.object_list %}
    <table id="tasks_list" class="table table-striped">
      <thead>
        <tr>
          <th>{% trans "Médico" %}</th>
          <th>{% trans "Fecha límite" %}</th>
          <th>{% trans "Última modificación" %}</th>
        </tr>
      </thead>
      <tbody>
        {% for task in tasks.object_list %}
          <tr data-msg="{{ task.id }}" style="cursor:pointer">
            <td>{{ task.patient.get_profile.doctor.get_full_name }}</td>
            <td>{{ task.patient.get_profile.get_nextAppointment.date|date:'d/M/Y' }}</td>
             <td>{{ task.updated_at|date:'d/M/Y H:i' }}</td>              
          </tr>
        {% endfor %}
      </tbody>
    </table>
    {% include 'ui/includes/pagination_bar.html' with objects=tasks %}

    <div id="preview"></div>
    {% else %}
        <div class="alert alert-info">{% trans "No hay cuestionarios pendientes en este momento" %}</div>
    {% endif %}
  </div>
</section>

{% endblock container %}
{% block jquery_init %}

$('table tbody tr').on('click', function(event){
  var id = $(this).attr('data-msg');
  window.location.href = '/surveys/block/' + id; 
});

{% endblock %}