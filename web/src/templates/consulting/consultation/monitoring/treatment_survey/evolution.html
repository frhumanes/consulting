{% extends "consulting/consultation/monitoring/index.html" %}

{% load i18n%}

{% block js_files %}
  {{ block.super }}
    <script src="{{ STATIC_URL }}js/jquery.flot.js"></script>
  <script language="javascript" type="text/javascript" src="{{ STATIC_URL }}js/jquery.flot.resize.js"></script>
{% endblock %}

{% block container %}
  <div class="page-header">
      <h1>{% trans 'Evoluci√≥n' %} {{task.survey.name}}</h1>
  </div>
  <div class="well center">
  <div id="placeholder" style="width:100%;height:300px;"></div>
  </div>
  
<script type="text/javascript">
$(function () {
    var data = [
      {% for label, item in values.items %}
       {
            label: "{{label|upper}}",
            data: [{% for date, val in item %}[(Date.UTC({{date|date:'Y, m, d'}})), {{val|floatformat:0}}],{% endfor %}]
        },        
       {% endfor %}
    ];

    // hard-code color indices to prevent them from shifting as
    // countries are turned on/off
    var i = 0;
    $.each(data, function(val) {
        val.color = i;
        ++i;
    });
    
  
      $.plot($("#placeholder"), data, {
        lines: { show: true },
        points: { show: true },
        yaxis: { min: 0, max: 4, ticks: 5, position: "right"},
        xaxis: { mode: "time", 
                 minTickSize: [1, "day"], 
                 min: (Date.UTC({{ticks|first|date:'Y, m, d'}})),
                 max: (Date.UTC({{ticks|last|date:'Y, m, d'}}))
               },
      });
  });
</script>
<div class="pull-right">
  <a id="goback" href="{% url consulting_main id_appointment=appointment.id code_illness=illness.code %}" class="btn btn-info btn-large">
    {% trans 'Volver' %}
  </a>         
</div>                             
{% endblock container %}

