{% extends "ui/app.html" %}

{% load i18n %}

{% block js_files %}
  {{ block.super }}
  <script src="{{ STATIC_URL }}js/bootstrap-datepicker.js"></script>
{% endblock %}

{% block css_files %}
  {{ block.super }}
  <link href="{{ STATIC_URL }}css/datepicker.css" rel="stylesheet">
{% endblock %}

{% block body %}
<div class="container">
  <section>
  <div class="page-header">
    <h1>{% trans 'Encuesta Autoadministrada' %}</h1>
  </div>
  <div class="row">
    <div class="span8">
      <div class="hero-unit center">
        <form class="form-horizontal" method="post" action="{% url consulting_select_survey id_appointment %}">{% csrf_token %}
            {% if form.survey.errors %}
              <div class="control-group error">
                <label class="control-label">
                  {{form.survey.label}}
                </label>
                <div class="controls">
                  {{ form.survey }}
                  {% for error in form.survey.errors %}
                    <span class="help-inline">
                      {{ error|escape }}
                    </span>
                  {% endfor %}
                </div>
              </div>
            {% else %}
              <div class="control-group">
                <label class="control-label">
                  {{form.survey.label}}
                </label>
                <div class="controls">
                  {{ form.survey }}
                </div>
              </div>
            {% endif %}              
            {% if form.from_date.errors %}
              <div class="control-group error">
                <label for="id_from_date" class="control-label">{{form.from_date.label}}</label>
                <div id="from_date" class="input-append date" data-date-format="dd/mm/yyyy" data-date-weekstart="1">
                  {{ form.from_date }} 
                  <span class="add-on">
                    <i class="icon-th"></i>
                  </span>                   
                  {% for error in form.from_date.errors %}
                     <span class="help-inline">{{ error|escape }}</span>
                  {% endfor %}
                </div>               
              </div>
            {% else %}
              <div class="control-group">
                <label for="from_date" class="control-label">{{form.from_date.label}}</label>
                <div id="from_date" class="input-append date" data-date-format="dd/mm/yyyy" data-date-weekstart="1">
                  {{ form.from_date }}
                  <span class="add-on">
                    <i class="icon-th"></i>
                  </span>
                </div>
              </div>
            {% endif %}
            {% if form.to_date.errors %}
              <div class="control-group error">
                <label for="to_date" class="control-label">{{form.to_date.label}}</label>
                <div id="to_date" class="input-append date" data-date-format="dd/mm/yyyy" data-date-weekstart="1">
                  {{ form.to_date }}
                  <span class="add-on">
                    <i class="icon-th"></i>
                  </span>
                  {% for error in form.to_date.errors %}
                     <span class="help-inline">{{ error|escape }}</span>
                  {% endfor %}
                </div>
              </div>
            {% else %}
              <div class="control-group">
                <label for="id_to_date" class="control-label">{{form.to_date.label}}</label>
                <div id="to_date" class="input-append date" data-date-format="dd/mm/yyyy" data-date-weekstart="1">
                  {{ form.to_date }}
                  <span class="add-on">
                    <i class="icon-th"></i>
                  </span>
                </div>
              </div>
            {% endif %}
            <div class="controls span1">
              <button type="submit" class="btn btn-primary btn-large">
                {% trans 'Guardar' %}
              </button>
            </div>
        </form>
      </div>
      <div class="pull-right">
        <button id="carryon" class="btn btn-info btn-large">
          {% trans 'Variables' %}
        </button>         
      </div>
    </div>
    <!-- PATIENT CARD -->
    <div class="span4">
        {% include "consulting/patient/card.html" %}
    </div>
  </div>
</div>
{% endblock body %}


{% block jquery_init %}
  $('#from_date').datepicker().on('changeDate',
    function(ev){$('#from_date').datepicker('hide');
  });
  $('#to_date').datepicker().on('changeDate',
    function(ev){$('#to_date').datepicker('hide');
  });
  $('#carryon').on("click", function(){  
      window.location.href = '/consultation/select_variables/' + {{id_appointment}};  
  });
{% endblock %}